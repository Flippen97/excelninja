"use strict";!function(){function t(){this.toggleNav(),this.arrowNavigation(),this.mobileVhFix(),document.querySelector(".home")&&this.menuLinksScroll(),document.getElementById("section4")&&(this.caseSection(),this.offerListiner())}function e(){var t=window.matchMedia("(max-height: 500px) and (max-width: 900px)"),e=window.matchMedia("(max-height: 800px) and (max-width: 1050px) and (min-width: 760px) and (min-height:600px)");t.matches?n(2):e.matches?n(5):n(3)}function n(t){if(3===t)var n=tns({container:".caseCarousel",items:3,controls:!1,nav:!1,autoplayButtonOutput:!1,axis:"vertical",touch:!1,autoplay:!0,speed:2e3,autoplayTimeout:1e4,responsive:{330:{items:4},760:{items:6},1200:{items:3}}});else n=tns({container:".caseCarousel",items:t,controls:!1,nav:!1,autoplayButtonOutput:!1,axis:"vertical",touch:!1,speed:2e3,autoplayTimeout:1e4,autoplay:!0});window.addEventListener("resize",function t(){n.destroy();window.removeEventListener("resize",t,!1);e()},!1)}t.prototype.menuLinksScroll=function(){for(var t=document.querySelectorAll(".scroll"),e=0;e<t.length;e++)t[e].addEventListener("click",function(t){t.preventDefault();var e=document.getElementById("slide-nav-btn"),n=document.getElementById("slide-nav");e.classList.remove("slide-nav-btn-active"),n.classList.remove("slide-nav-active");var i=this.hash;setTimeout(function(){document.querySelector(i).scrollIntoView({behavior:"smooth"})},400)})},t.prototype.offerListiner=function(){for(var t=this,e=document.querySelectorAll(".offerButton"),n=0;n<e.length;n++)e[n].addEventListener("click",function(){t.singleOffer(this.dataset.id)})},t.prototype.singleOffer=function(t){fetch("http://localhost:8888/offersPage.html").then(function(t){return t.text()}).then(function(e){var n=(new DOMParser).parseFromString(e,"text/html").querySelector("#offerspageCard"+t),i=document.querySelector(".offers"),o=document.createElement("div");o.className="offersPageWrapper";var a=document.createElement("button");a.setAttribute("role","button"),a.className="offersPageClose",a.innerText="Stäng",n.prepend(a),o.appendChild(n),i.appendChild(o),window.addEventListener("click",function t(e){var n=document.querySelector(".offersPageWrapper");var o=document.querySelector(".offersPageClose");e.target!==n&&e.target!==o||(window.removeEventListener("click",t,!1),i.removeChild(i.lastChild))},!1)}).catch(function(t){console.log("Failed to fetch page: ",t)})},t.prototype.mobileVhFix=function(){var t=Math.max(document.documentElement.clientHeight,window.innerHeight||0);document.getElementById("section1").style["min-height"]=t+"px",document.querySelector(".slide-nav").style["min-height"]=t+"px";var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0);window.addEventListener("resize",function(){var n=Math.max(document.documentElement.clientWidth,window.innerWidth||0);e!=n&&setTimeout(function(){t=Math.max(document.documentElement.clientHeight,window.innerHeight||0),document.getElementById("section1").style["min-height"]=t+"px",document.querySelector(".slide-nav").style["min-height"]=t+"px",e=Math.max(document.documentElement.clientWidth,window.innerWidth||0)},500)})},t.prototype.toggleNav=function(){var t=document.getElementById("slide-nav-btn"),e=document.getElementById("slide-nav");t.addEventListener("click",function(){t.classList.toggle("slide-nav-btn-active"),e.classList.toggle("slide-nav-active")})},t.prototype.arrowNavigation=function(){var t=this;window.addEventListener("keydown",function(e){if(!e.defaultPrevented){var n=t.getCurrentUrl();switch(e.key){case"Down":case"ArrowDown":t.changeHash(+n+1);break;case"Up":case"ArrowUp":if("1"===n)return;t.changeHash(+n-1);break;default:return}e.preventDefault()}},!0)},t.prototype.getCurrentUrl=function(){var t=window.location.href.split("http://excelninja.se/#section")[1];return void 0===t&&(t=1),t},t.prototype.changeHash=function(t){var e="section"+t;document.getElementById("section"+t).scrollIntoView({behavior:"smooth"}),setTimeout(function(){window.location.hash=e},500)},t.prototype.caseSection=function(){fetch("http://excelninja.se/server/fetchCase.php").then(function(t){return t.json()}).then(function(t){var n=document.getElementById("section4"),i=document.createElement("section");i.className="caseSection",i.id="section5";var o='<h2>TIDIGARE UPPDRAG</h2><div class="caseCarousel">';t.map(function(t){console.log(t.title),o+='<form action="singleCase.html" class="caseCard">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<h3 class="caseCardCategory">'+t.company+'</h3>\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<h4 class="caseCardHeading">'+t.title+'</h4>\n\t\t\t\t\t\t\t\t\t\t\t<p class="caseCardProblem">'+t.problem+'</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<label for="id" hidden>Id:</label>\n\t\t\t\t\t\t\t\t\t\t<input type="text" name="id" value="'+t.id+'" hidden/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<button class="caseCardButton"><span>Läs mer om Case</span></button>\n\t\t\t\t\t\t\t\t</form>'}),o+="</div>",i.innerHTML=o,n.parentNode.insertBefore(i,n.nextSibling),e()})},new t}(),function(){function t(){var t,e,n=this;this.adminBody=document.querySelector(".adminProfile"),this.adminPanel(),this.clickHandler=(t="click",e=function(t){var e=document.querySelector(".caseForm"),i=t.target;console.log(e),console.log(t.target);do{if(i==e)return void console.log("remove");i=i.parentNode}while(i);console.log("do nothing"),n.clickHandler.unlisten(document);var o=document.querySelector(".adminProfile");o.removeChild(o.lastChild)},{listen:function(n){n.addEventListener(t,e)},unlisten:function(n){n.removeEventListener(t,e)}})}t.prototype.adminPanel=function(){document.querySelector(".adminProfile")&&this.fetchCases()},t.prototype.fetchCases=function(){var t=this;fetch("http://excelninja.se/server/fetchCase.php").then(function(t){return t.json()}).then(function(e){t.printCases(e)})},t.prototype.printCases=function(t){var e='<div class="searchCases"><input type="text" name="searchCases" id="searchCases" required/><label for="searchCases">Search:</label></div><div class="cases">';t.map(function(t){console.log(t.title),e+='<div class="case">\n\t\t\t\t\t\t\t<div class="id">'+t.id+'</div>\n\t\t\t\t\t\t\t<div class="title">'+t.title+'</div>\n\t\t\t\t\t\t\t<div class="company">'+t.company+'</div>\n\t\t\t\t\t\t\t<button class="updateButton" data-id="'+t.id+'">Uppdatera</button>\n\t\t\t\t\t\t\t<button class="deleteButton" data-id="'+t.id+'">Radera</button>\n\t\t\t\t\t\t</div>'}),e+='</div><button class="newCaseButton" type="button">Skapa case</button><a href="logout.php">Logout</a>',this.adminBody.innerHTML+=e,this.addingEventListener()},t.prototype.addingEventListener=function(){for(var t=this,e=document.getElementsByClassName("deleteButton"),n=0;n<e.length;n++)e[n].addEventListener("click",function(){1==confirm("Är du säker du vill radera?")&&t.deleteCase(this.dataset.id)});var i=document.getElementsByClassName("updateButton");for(n=0;n<i.length;n++)i[n].addEventListener("click",function(){console.log(this.dataset.id),fetch("http://excelninja.se/server/fetchCaseWithId.php",{method:"POST",mode:"cors",body:JSON.stringify({id:this.dataset.id})}).then(function(t){return t.json()}).then(function(e){console.log(e[0].title),t.printCaseForm(e)})});document.querySelector(".newCaseButton").addEventListener("click",function(){t.printCaseForm()})},t.prototype.printCaseForm=function(t){var e=this,n=document.createElement("div");n.className="caseFormWrapper";var i=document.createElement("form");i.className="caseForm",i.innerHTML=(t?'<div><label for="id" style="display:none;" hidden>Id:</label><input type="text" id="id" name="id" value="'+t[0].id+'" hidden/></div>':"<div></div>")+'\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<label for="title">Titel:</label>\n\t\t\t\t\t\t\t\t<input type="text" id="title" name="title" '+(t?'value="'+t[0].title+'" ':"")+'/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<label for="company">Företag: </label>\n\t\t\t\t\t\t\t\t<input type="text" id="company" name="company" '+(t?'value="'+t[0].company+'" ':"")+'/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<label for="priority">Prio: </label>\n\t\t\t\t\t\t\t\t<input type="text" id="priority" name="priority" '+(t?'value="'+t[0].priority+'" ':"")+'/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<label for="problem">Problem: </label>\n\t\t\t\t\t\t\t\t<textarea id="problem" name="problem">'+(t?t[0].problem:"")+'</textarea>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<label for="implementation">Utförande: </label>\n\t\t\t\t\t\t\t\t<textarea id="implementation" name="implementation">'+(t?t[0].implementation:"")+'</textarea>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<label for="results">Resultat: </label>\n\t\t\t\t\t\t\t\t<textarea id="results" name="results">'+(t?t[0].results:"")+'</textarea>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<label for="reference">Referens: </label>\n\t\t\t\t\t\t\t\t<textarea id="reference" name="reference">'+(t?t[0].reference:"")+"</textarea>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<button>"+(t?"Uppdatera":"Skapa case")+"</button>",n.appendChild(i),document.querySelector(".adminProfile").appendChild(n),document.querySelector(".caseForm").addEventListener("submit",function(n){n.preventDefault();var i={};new FormData(n.target).forEach(function(t,e){i[e]=t}),console.log(i),e.clickHandler.unlisten(document),t?e.updateCase(i):e.createCase(i)}),setTimeout(function(){e.clickHandler.listen(document)},10)},t.prototype.updateCase=function(t){fetch("http://excelninja.se/server/updateCase.php",{method:"POST",mode:"cors",body:JSON.stringify({id:t.id,title:t.title,company:t.company,problem:t.problem,implementation:t.implementation,results:t.results,reference:t.reference,priority:t.priority})}).then(function(t){return t.json()}).then(function(t){console.log(t)}).catch(function(t){console.log(t)});var e=document.querySelector(".adminProfile");e.removeChild(e.lastChild)},t.prototype.createCase=function(t){fetch("http://excelninja.se/server/createCase.php",{method:"POST",mode:"cors",body:JSON.stringify({title:t.title,company:t.company,problem:t.problem,implementation:t.implementation,results:t.results,reference:t.reference,priority:t.priority})}).then(function(t){return t.json()}).then(function(t){console.log(t)}).catch(function(t){console.log(t)});var e=document.querySelector(".adminProfile");e.removeChild(e.lastChild)},t.prototype.deleteCase=function(t){fetch("http://excelninja.se/server/deleteCase.php",{method:"POST",mode:"cors",body:JSON.stringify({id:t})}).then(function(t){return t.json()}).then(function(t){console.log(t)}).catch(function(t){console.log(t)})},new t}(),function(){function t(){console.log("test"),this.getSingleCaseId()}t.prototype.getSingleCaseId=function(){var t=window.location.href,e=new Array;void 0!=(e=t.split("?id="))[1]&&this.printSingleCase(e[1])},t.prototype.printSingleCase=function(t){fetch("http://excelninja.se/server/fetchCaseWithId.php",{method:"POST",mode:"cors",body:JSON.stringify({id:t})}).then(function(t){return t.json()}).then(function(t){console.log(t[0].title);var e='\n\t\t\t\t\t<div class="singleCaseWrapper">\n\t\t\t\t\t\t<a href="/">Tillbaka</a>\n\t\t\t\t\t\t<h1>'+t[0].title+'</h1>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class="imageWrapper"><img src="Assets/warning.png" alt="Problem icon"></div>\n\t\t\t\t\t\t\t<div class="contentWrapper">\n\t\t\t\t\t\t\t\t<h2>KUNDENS​ <span>UTMANING</span></h2>\n\t\t\t\t\t\t\t\t<p>'+t[0].problem+'</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class="imageWrapper"><img src="Assets/plan.png" alt="Utförande icon"></div>\n\t\t\t\t\t\t\t<div class="contentWrapper">\n\t\t\t\t\t\t\t\t<h2>VÄGEN​ <span>FRAMÅT</span></h2>\n\t\t\t\t\t\t\t\t<p>'+t[0].implementation+'</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class="imageWrapper"><img src="Assets/target.png" alt="Resultat icon"></div>\n\t\t\t\t\t\t\t<div class="contentWrapper">\n\t\t\t\t\t\t\t\t<h2>UPPNÅTT​ <span>RESULTAT</span></h2>\n\t\t\t\t\t\t\t\t<p>'+t[0].results+"</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>";document.querySelector(".singleCase").innerHTML=e})},document.querySelector(".singleCase")&&new t}();